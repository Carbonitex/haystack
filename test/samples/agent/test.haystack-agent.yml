version: ignore

components:
  - name: AgentPromptNode
    type: PromptNode
    params:
      model_name_or_path: DavinciModel
      stop_words: ['Observation:']
  - name: DavinciModel
    type: PromptModel
    params:
      model_name_or_path: 'text-davinci-003'
      api_key: 'XYZ'
  - name: Serp
    type: SerpAPIComponent
    params:
      api_key: 'XYZ'
  - name: CalculatorInput
    type: PromptNode
    params:
      model_name_or_path: DavinciModel
      default_prompt_template: CalculatorTemplate
      output_variable: python_runtime_input
  - name: Calculator
    type: PythonRuntime
  - name: CalculatorTemplate
    type: PromptTemplate
    params:
      name: calculator
      prompt_text:  |
          # Write a simple python function that calculates
          # $query
          # Do not print the result; invoke the function and assign the result to final_result variable
          # Start with import statement

pipelines:
  - name: calculator_pipeline
    nodes:
      - name: CalculatorInput
        inputs: [Query]
      - name: Calculator
        inputs: [CalculatorInput]

agents:
  - name: agent
    params:
      prompt_node: AgentPromptNode
      tools:
        - name: Search
          pipeline_or_node: Serp
          description: >
            useful for when you need to answer questions about current events.
            You should ask targeted questions
        - name: Calculator
          pipeline_or_node: calculator_pipeline
          description: >
            useful for when you need to answer questions about math
